{% import 'utility.macros.j2' as utility %}
{% import 'content.macros.j2' as content %}
{% import 'birds/utility.macros.j2' as birds %}


{% macro social(slug='contact/index', data='social') %}
  {% set items = slug|get_config(data) %}

  <ul class="socials">
    {% for item in items %}
      <li class="social-item">
        {% set content = get_social_content(item.icon, item.text) %}
        {{ utility.link_if(content, item.url, 'icon-link') }}
        {{ item.after }}
      </li>
    {% endfor %}
  </ul>
{% endmacro %}


{% macro get_social_content(icon, text) %}
  {{ utility.icon(icon) }}
  <span class="icon-text">{{ text }}</span>
{% endmacro %}


{% macro footer(
  location,
  action=none
) %}
  {% set actions = {
    'design-systems': 'workshop'
  } %}
  {% set action = action or actions[location] or 'default' %}
  {% set page = all_pages|filter_pages('cta_is', 'eq', action)|get_page %}
  {% set cta = page.config.cta_meta[0] %}

  {% if page %}
    {% set title %}
      <h2>{{ cta.title|typogrify }}</h2>
    {% endset %}

    {% set title %}
      {% if cta.img %}
        <header class="cta-header">
          <img src="static/images/{{ cta.img }}" alt="{{ cta.alt }}">
          {{ title }}
        </header>
      {% else %}
        {{ title }}
      {% endif %}
    {% endset %}

    {% set content %}
      {{ title }}
      {{ page.render_summary() }}
    {% endset %}

    {% set content %}
      {% if cta.face %}
        {{ birds.face_block(
          cta.face,
          content
        ) }}
      {% else %}
        {{ content }}
      {% endif %}
    {% endset %}

    <div class="cta-footer">
      <section data-module="cta-content">
        {{ content }}
      </section>
    </div>
  {% endif %}
{% endmacro %}
